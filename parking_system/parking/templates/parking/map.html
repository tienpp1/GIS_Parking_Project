<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Báº£n Ä‘á»“ bÃ£i Ä‘á»— xe</title>

    <!-- Leaflet CSS -->
    <link
        rel="stylesheet"
        href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />

    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        #map {
            height: 600px;
            width: 100%;
        }
    </style>
</head>
<body>

<h2>Báº£n Ä‘á»“ bÃ£i Ä‘á»— xe</h2>

<div id="map"></div>

<!-- Leaflet JS -->
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
    // 1ï¸âƒ£ KHá»I Táº O Báº¢N Äá»’ (TP.HCM)
    var map = L.map('map').setView([10.7769, 106.7009], 13);

    // 2ï¸âƒ£ TILE MAP
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: 'Â© OpenStreetMap'
    }).addTo(map);

    // 3ï¸âƒ£ Dá»® LIá»†U Tá»ª DJANGO
    var parkingLots = {{ parking_lots|safe }};

    // 4ï¸âƒ£ Váº¼ MARKER + CLICK CHUYá»‚N TRANG
    parkingLots.forEach(function(p) {
        if (p.latitude && p.longitude) {

            var marker = L.marker([p.latitude, p.longitude]).addTo(map);

            marker.bindPopup(
                "<b>" + p.name + "</b><br>" +
                "Äá»‹a chá»‰: " + p.address + "<br>" +
                "<i>Click marker Ä‘á»ƒ xem chi tiáº¿t</i>"
            );

            // ğŸ‘‰ CÃCH 2: CLICK â†’ REDIRECT
            marker.on('click', function () {
                window.location.href = "/parking/" + p.id + "/";
            });
        }
    });
</script>

</body>
</html>
